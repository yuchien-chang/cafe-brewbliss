
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Brew Bliss</title>
  <link rel="stylesheet" href="style.css" />

  <style>
        .font_1 { font-size: 24px; }
        .font_2 { font-size: 20px; }
        .font_3 { font-size: 16px; }
    </style>

        <script>
        function getUserName() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('user') || 'Guest';
        }

        window.onload = () => {
            const user = getUserName();

            // ✅ Show username in the welcome message
            document.getElementById('welcome-user').textContent = user;

            // ✅ Add ?user=username to all nav links EXCEPT logout (index.html)
            document.querySelectorAll('a.btn').forEach(link => {
            const href = link.getAttribute('href');
            if (href && href.endsWith('.html') && !href.includes('index.html')) {
                const base = href.split('?')[0];
                link.href = `${base}?user=${encodeURIComponent(user)}`;
            }
            });
        };
        </script>


    <script>
        function ChangeFont(fontClass) {
          document.body.className = fontClass;
        }
    </script>

</head>
<body>

  <nav id="nav">
      <div class="navTop">
        <div class="navItem">
          <img src="images/Contact/logo.png" alt="logo" class="logo">
        </div>


        <div class="navItem">
            <a class="btn" href="main.html">Home</a>
        </div>
 
        <div class="navItem">
            <div class="search">
              <a class="btn" href="searchalrlogin.html">Search</a>
            </div>
        </div>
 
        <div class="navItem navLinks">
          <a class="btn" href="menualrlogin.html">Menu</a>
        </div>

        <div class="navItem navLinks">
          <a class="btn" href="admin.html">Admin</a>
          <a class="btn" href="index.html">Logout</a>
        </div>
    </nav>


<br>
<main class="dashboard_main">
  <header>
    <h1>Admin Dashboard</h1>
  </header>


  <br>

  <section class="order_table">
    <h2>Orders</h2>
    <table>
      <thead>
        <tr>
        <th>Order Id</th>
        <th>Username</th>
        <th>Products</th>
        <th>Quantity</th>
        <th>Price</th>
      </tr>
      </thead>
      <tbody id="order_items">
        <!-- Filled by fetch -->
      </tbody>
    </table>
  </section>

  <br>

  <section class="purchase_table">
    <h2>Purchase History</h2>
    <table>
      <thead>
        <tr>
        <th>Id</th>
        <th>Username</th>
        <th>Phone Number</th>
        <th>Address</th>
        <th>Card Number</th>
        <th>Expiry Month</th>
        <th>Expiry Year</th>
        <th>CVV</th>
        <th>Purchase Time</th></tr>
      </thead>
      <tbody id="purchasehistory">
        <!-- Filled by fetch -->
      </tbody>
    </table>
  </section>
</main>

  <script>
    async function loadData() {
      try {
        let res = await fetch('admin_data.php');
        let data = await res.json();

        const loginTbody = document.getElementById('loginhistory');
        data.logins.forEach(log => {
          let tr = document.createElement('tr');
          tr.innerHTML = `<td>${log.username}</td><td>${log.login_time}</td>`;
          loginTbody.appendChild(tr);
        });

        const purchaseTbody = document.getElementById('purchasehistory');
        data.purchases.forEach(p => {
          let tr = document.createElement('tr');
          tr.innerHTML = `<td>${p.username}</td><td>${p.product}</td><td>${p.purchase_time}</td>`;
          purchaseTbody.appendChild(tr);
        });
      } catch(e) {
        console.error(e);
      }
    }
    loadData();
  </script>

<br>

  <footer>
  <div class="footerLeft">
      <div class="footerMenu">
          <h1 class="fMenuTitle">About Us</h1>
          <ul class="fList">
              <li class="fListItem"><strong>Opening hour</strong><br>
              every day from 8:00 AM to 9:00 PM</li>
              <li class="fListItem"><strong>Location</strong><br>
              10 Downing Street, London SW1A 1AA</li>
              <li class="fListItem"><strong>Contact number</strong><br>
              +60123456789</li>
              <li class="fListItem"><strong>Email</strong><br>
              brewbliss@gmail.com</li>
          </ul>
      </div>


<div class="footerMenu">
          <div>
        <h1 class="fMenuTitle">Text Size</h1>
              <div>
                <a class="font_1" onclick="javascript:ChangeFont('font_1');" href="javascript:void(0);">Aa</a>
                <a class="font_2" onclick="javascript:ChangeFont('font_2');" href="javascript:void(0);">Aa</a>
                <a class="font_3" onclick="javascript:ChangeFont('font_3');" href="javascript:void(0);">Aa</a>
              </div>


          </div>
        </div>
  </div>
  <div class="footerRight">
      <div class="footerRightMenu">
          <h1 class="fMenuTitle">Subscribe to our channel</h1>
      </div>
      <div class="footerRightMenu">
          <h1 class="fMenuTitle">Follow Us</h1>
          <div class="fIcons">
              <img src="./images/Contact/facebook.png"  alt="facebook" class="fIcon">
              <img src="./images/Contact/instagram.png" alt="instagram" class="fIcon">
              <img src="./images/Contact/whatsapp.png" alt="whatsapp" class="fIcon">
          </div>
      </div>
      <div class="footerRightMenu">
          <span class="copyright">© 2025 Brew Bliss. All rights reserved.</span>
      </div>
  </div>
</footer>
